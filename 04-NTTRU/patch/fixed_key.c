#include <string.h>

#include "fixed_key.h"

// Fixed coins copied from the original local experiment code (N=768).
static const unsigned char coins_fixed[N] = {
    57,  82,  11,  16,  239, 104, 27,  164, 156, 148, 158, 91,  108, 136, 43,  250,
    37,  42,  142, 104, 210, 104, 212, 236, 225, 158, 112, 95,  84,  110, 17,  246,
    90,  190, 210, 71,  240, 97,  255, 133, 102, 181, 30,  137, 202, 29,  0,   199,
    166, 200, 69,  168, 228, 160, 159, 216, 43,  146, 171, 58,  50,  13,  158, 113,
    64,  145, 183, 213, 80,  131, 194, 5,   140, 197, 0,   212, 39,  237, 25,  22,
    62,  12,  66,  241, 135, 77,  118, 234, 117, 13,  113, 130, 28,  36,  249, 135,
    193, 30,  122, 166, 92,  85,  169, 11,  132, 65,  238, 176, 16,  136, 41,  60,
    160, 251, 136, 8,   210, 158, 204, 215, 110, 196, 179, 10,  114, 30,  188, 242,
    71,  62,  217, 123, 102, 187, 170, 220, 187, 29,  252, 113, 190, 208, 234, 185,
    6,   217, 200, 190, 181, 86,  182, 0,   3,   162, 161, 163, 181, 147, 23,  85,
    181, 69,  216, 4,   103, 172, 145, 19,  79,  180, 149, 174, 255, 19,  93,  65,
    163, 4,   16,  112, 57,  129, 24,  122, 84,  123, 116, 157, 212, 30,  69,  140,
    33,  85,  45,  73,  56,  222, 4,   190, 46,  184, 194, 141, 75,  188, 57,  12,
    251, 218, 48,  238, 67,  46,  10,  117, 131, 190, 159, 220, 175, 14,  107, 234,
    174, 196, 206, 140, 17,  58,  67,  168, 118, 60,  180, 129, 72,  129, 131, 112,
    142, 29,  65,  35,  190, 203, 87,  125, 198, 35,  51,  127, 214, 191, 193, 2,
    147, 2,   243, 88,  26,  247, 158, 30,  7,   206, 85,  220, 124, 53,  1,   79,
    116, 51,  53,  222, 111, 242, 88,  33,  168, 123, 116, 205, 221, 98,  151, 11,
    43,  144, 58,  185, 143, 76,  57,  248, 134, 18,  95,  133, 28,  3,   165, 184,
    29,  104, 12,  127, 209, 43,  58,  20,  158, 149, 158, 236, 143, 150, 139, 245,
    178, 161, 86,  65,  68,  245, 237, 23,  205, 59,  31,  239, 21,  194, 198, 135,
    103, 40,  148, 183, 114, 167, 122, 169, 187, 137, 62,  248, 149, 211, 197, 186,
    31,  110, 45,  5,   192, 93,  165, 232, 119, 180, 226, 54,  168, 30,  108, 12,
    250, 139, 237, 21,  191, 53,  223, 219, 119, 192, 27,  222, 238, 106, 142, 22,
    219, 246, 52,  29,  189, 156, 211, 253, 200, 162, 185, 10,  125, 236, 113, 32,
    104, 88,  189, 113, 104, 19,  239, 94,  155, 205, 119, 172, 83,  60,  81,  192,
    157, 147, 223, 189, 47,  253, 214, 71,  62,  130, 103, 101, 56,  11,  87,  234,
    29,  64,  190, 115, 228, 114, 134, 155, 1,   131, 6,   18,  81,  157, 105, 171,
    204, 87,  58,  111, 83,  254, 35,  248, 250, 107, 145, 146, 76,  191, 34,  215,
    36,  132, 220, 45,  89,  175, 187, 60,  64,  12,  72,  135, 221, 182, 2,   79,
    40,  170, 30,  255, 144, 1,   142, 111, 57,  145, 220, 199, 201, 58,  96,  134,
    138, 123, 189, 211, 159, 248, 81,  172, 86,  161, 187, 124, 74,  54,  46,  246,
    201, 211, 176, 226, 206, 171, 19,  191, 10,  153, 119, 182, 195, 245, 55,  26,
    206, 108, 195, 0,   23,  240, 235, 115, 177, 90,  141, 5,   90,  102, 109, 150,
    164, 196, 106, 150, 119, 222, 244, 195, 103, 146, 48,  84,  213, 88,  193, 219,
    116, 188, 241, 142, 210, 63,  210, 169, 82,  124, 203, 163, 197, 246, 223, 93,
    44,  142, 194, 86,  63,  70,  23,  247, 39,  218, 12,  123, 179, 52,  120, 252,
    29,  178, 121, 145, 20,  52,  133, 206, 120, 222, 247, 247, 172, 135, 204, 226,
    85,  23,  96,  142, 240, 91,  70,  97,  232, 54,  115, 99,  23,  29,  219, 93,
    75,  229, 93,  56,  137, 156, 170, 241, 78,  227, 93,  229, 110, 110, 217, 186,
    174, 240, 115, 193, 4,   188, 192, 74,  108, 224, 245, 38,  44,  125, 194, 212,
    237, 171, 119, 159, 83,  86,  225, 122, 241, 37,  17,  54,  30,  72,  193, 158,
    210, 67,  108, 153, 56,  90,  47,  183, 242, 144, 171, 169, 91,  108, 148, 218,
    186, 248, 62,  77,  164, 68,  201, 11,  152, 108, 12,  224, 254, 236, 17,  18,
    2,   135, 204, 161, 76,  25,  183, 139, 9,   153, 44,  73,  64,  218, 44,  162,
    214, 230, 17,  184, 86,  233, 86,  252, 248, 251, 216, 186, 48,  203, 221, 18,
    231, 142, 250, 255, 20,  39,  56,  99,  197, 169, 3,   64,  41,  130, 56,  69,
    107, 241, 31,  198, 77,  134, 216, 76,  77,  39,  123, 188, 237, 49,  212, 198,
};

void nttru_fill_coins_fixed(unsigned char coins[N]) { memcpy(coins, coins_fixed, N); }

void nttru_fill_coins_xorshift(unsigned char coins[N], uint32_t seed)
{
	uint32_t x = seed;
	for (size_t i = 0; i < N; i++) {
		x ^= x << 13;
		x ^= x >> 17;
		x ^= x << 5;
		coins[i] = (unsigned char)x;
	}
}

